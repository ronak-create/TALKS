<div class="post" id="post_{{ post.post_id }}">
  <div class="post-header">
    <p><strong>{{ post.username }}</strong></p>
    <div class="post-options">
      <button class="options-btn" data-post-id="{{ post.post_id }}">
        <i class="fa fa-ellipsis-v"></i>
      </button>
      <div class="options-menu" id="options-menu-{{ post.post_id }}">
        <ul>
          {% if session['username'] == post.username %}
          <li>
            <a href="#" class="edit-post" data-post-id="{{ post.post_id }}"
              >Edit Post</a
            >
          </li>
          <li>
            <a href="{{ url_for('delete_post', post_id=post.post_id) }}"
              >Delete Post</a
            >
          </li>
          {%else%}
          <li>
            <a href="#" class="report-post" data-post-id="{{ post.post_id }}"
              >Report Post</a
            >
          </li>
          {% endif %}
        </ul>
      </div>
    </div>
    <div class="modal" id="editModal_{{ post.post_id }}" style="display: none">
      <div class="modal-content">
        <form
          action="{{ url_for('edit_post', post_id=post.post_id) }}"
          method="POST"
        >
          <textarea name="content">
            {{ post.post_content_raw }}</textarea
          >
          <div class="modal-lower">
            <button type="submit" class="btn">Save Changes</button>
            <span class="close" data-post-id="{{ post.post_id }}">&times;</span>
          </div>
        </form>
      </div>
    </div>
  </div>
  <p>{{ post.post_content | safe}}</p>
  <div class="post-actions">
    <div>
      <button
        class="like-post {% if post.is_liked %} liked {%endif%}"
        data-post-id="{{ post.post_id }}"
      >
        <i
          class="fa-regular fa-heart {% if post.is_liked %} fa-solid {%endif%}"
          data-post-id="{{post.post_id}}"
        ></i>
        <p>{{ post.like_count }}</p>
      </button>
      <button class="comment-toggle" data-post-id="{{ post.post_id }}">
        <i class="fa-regular fa-comment"></i>
        {{ post.comments|length }}
      </button>
      <div class="perks"><p>{{post.post_cost}} <i class="fa-solid fa-certificate"></i></p></div>
    </div>
    <p>{{ post.created_at }}</p>
  </div>
  <div
    class="comments-section"
    id="comments_{{ post.post_id }}"
    style="display: none"
  >
  <div class="comment-feed">

    {% for comment in post.comments %}
    <div class="comment">
      <p><strong>{{ comment.username }}:</strong> {{ comment.content }}</p>
      <button
      class="like-comment {% if comment.is_liked %} liked {%endif%}"
        data-comment-id="{{ comment.comment_id }}"
        >
        <i
        class="fa-regular fa-heart {% if comment.is_liked %} fa-solid {%endif%}"
        data-comment-id="{{comment.comment_id}}"
        ></i>
        <p>{{ comment.like_count }}</p>
      </button>
    </div>
    {% endfor %}
  </div>
    <form action="{{ url_for('comment', post_id=post.post_id) }}" method="POST">
      <input type="text" name="content" placeholder="Add a comment" />
      <button class="comment-btn" type="submit">Comment</button>
    </form>
  </div>
</div>
